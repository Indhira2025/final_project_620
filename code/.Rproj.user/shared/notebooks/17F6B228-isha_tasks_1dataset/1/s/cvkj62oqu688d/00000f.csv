"0","mean_excess_yr <- excess_death %>% mutate( mmwr_year = epiyear(week_ending_date)) %>% group_by(mmwr_year, state) %>% summarize(mean_percent_change = 100*mean(excess_deaths)/mean(expected_deaths), .groups = ""drop"") "
"0",""
"0","top_5_yr <- mean_excess_yr %>% group_by(mmwr_year) %>% slice_max(mean_percent_change, n = 5, with_ties = FALSE) %>% ungroup() %>% group_by(state) %>% summarize(years_in_top5 = n(), top_years = paste(sort(unique(mmwr_year)), collapse = "", ""))"
"0",""
"0","top_5_yr <- top_5_yr %>% mutate(top_years_wrapped = gsub(""^((?:[^,]+, ){2}[^,]+),\\s*"", ""\\1\n"", top_years))"
"0",""
"0","top_5_yr  %>% slice_max(years_in_top5, n = 5, with_ties = FALSE) %>%  ggplot(aes(x = reorder(state, years_in_top5), y = years_in_top5))+geom_col(fill = ""steelblue"") +  geom_text("
"0","    aes(label = top_years_wrapped),"
"0","    hjust = -0.1,"
"0","    size = 3"
"0","  ) + labs(title = ""States Most Frequently in the Top 5 for % Excess Mortality (2020-2025)"", x = ""State"", y = ""Years in Top 5"") + coord_flip() + theme(axis.text.x = element_text(angle = 45, hjust = 1)) +  ylim(0, max(top_5_yr$years_in_top5) + 1) + theme_minimal() "
